\documentclass[aps,prc,reprint,amsmath]{revtex4-1}

\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{lipsum}
%\usepackage{tabularx}
%\usepackage{dcolumn}
\graphicspath{{fig/}}

\newcommand{\trento}{T\raisebox{-0.5ex}{R}ENTo}
\newcommand{\avg}[1]{\langle #1 \rangle}
\newcommand{\nch}{N_\text{ch}}
\newcommand{\npart}{N_\text{part}}
\newcommand{\sqrts}{\sqrt{s_{NN}}}
%\newcolumntype{d}{D{.}{.}{-1}}

\begin{document}

\title{Determining quark-gluon plasma initial conditions and medium \\ properties from model-to-data simulations with minimal bias}

\author{J.\ Scott Moreland}
\author{Jonah E.\ Bernhard}
\author{Steffen A.\ Bass}
\affiliation{Department of Physics, Duke University, Durham, NC 27708-0305}

\date{\today}


\begin{abstract}
We aim to determine the quark-gluon-plasma initial conditions created in ultra-relativistic heavy-ion collisions and its temperature dependent transport coefficients utilizing Bayesian statistics and a multi-parameter model-to-data comparison.
The study is performed using \trento\ a recently developed parametric initial condition model for relativistic nuclear collisions which is able to interpolate among a general class of saturation based particle production scenarios [?].
The parameterization is compared to explicit calculations in Color-Glass Condensate effective field theory and embedded in a realistic hybrid model which couples event-by-event viscous hydrodynamics to a hadronic cascade.
We find that the parameterized initial conditions are highly constrained by bulk observables and provide a first set of constraints on the temperature dependence of the specific shear- and bulk-viscosities of the quark-gluon plasma.
\end{abstract}


\maketitle


\section{Introduction}

Simulations based on relativistic viscous hydrodynamics have been highly successful describing a wealth of bulk observables in heavy-ion collisions at the Relativistic Heavy-Ion Collider (RHIC) in Brookhaven, NY and the Large Hadron Collider (LHC) in Geneva, Switzerland. Initially, the success of hydrodynamic simulations was primarily qualitative. The framework elegantly described a number experimental phenomena, for example the existence of large azimuthal particle correlations, the mass ordering of these correlations and their characteristic momentum dependence.

Modern hydrodynamic simulations have greatly improved upon the successes of first-generation models. The addition of dissipative corrections to ideal hydrodynamics, event-by-event fluctuations in the colliding nuclei and modern lattice quantum chromodynamics (QCD) calculations for the quark-gluon plasma (QGP) equation of state are just a few examples of developments which have dramatically improved the agreement of hydrodynamic models with experiment.

These developments have positioned hydrodynamic modeling to evolve beyond a qualitative science and extract intrinsic properties of hot and dense QCD matter with quantitative uncertainties. A primary goal of the ongoing effort is to determine the temperature dependence of the QGP transport coefficients such as the specific shear viscosity $\eta/s$ which is theorized to reach a lower bound ${(\eta/s)(T) \ge 1/4\pi}$ near the QGP phase transition temperature. 

The dominant source of uncertainty in determining QGP transport coefficients from hydrodynamic model-to-data comparison is in modeling the initial stages of the collision. Model predictions vary with the choice of initial conditions and hence prefer hydrodynamic transport coefficients, e.g.\ QGP shear and bulk viscosities, which differ from calculation to calculation. For example, an estimate of the effective (constant) QGP shear viscosity $(\eta/s)_\text{QGP}$ needed to fit spectra and flows at RHIC found ${1/4\pi \le (\eta/s)_\text{QGP} \le 2.5/4\pi}$, where the uncertainty was largely attributable to a factor of two discrepancy in $(\eta/s)_\text{QGP}$ extracted with two different hydrodynamic initial condition models. 

The ongoing effort to constrain current bounds on the QGP shear viscosity typically focuses on improving theoretical descriptions of the initial conditions as well as the addition of new sensitive observables to assess the validity of each model's inherent assumptions and approximations. The process thus defines an iterative cycle in which theory calculations are embedded in hydrodynamic transport simulations and analyzed against a comprehensive list of bulk observables to determine the likelihood distributions of the model parameters.

Model optimization and comparison is complicated by the high-dimensional nature of the underconstrained parameter space. In addition to free parameters which describe the QGP transport coefficients, hydrodynamic simulations depend on a number of auxiliary parameters such as an effective nucleon width, QGP thermalization time and chemical freezeout temperature which require simultaneous optimization. Evaluating hydrodynamic models at a single point in parameter space may require tens of thousand of hydrodynamic simulations and thus brute force optimization techniques quickly become intractable. 

One solution to the model optimization problem is the use of modern Bayesian methods designed to tune computationally intensive models which depend on free parameters that live in large and highly correlated parameter spaces. A given model is first evaluated using a relatively small number of parameter configurations corresponding to discrete points in parameter space, and the model evaluations are used to train a Gaussian process emulator which interpolates model predictions between the training points. A standard Markov chain Monte Carlo algorithm is then be used to explore the parameter space interpolated by the emulator and isolate regions of parameter space which optimally replicate experiment. 

Bayesian methods have been applied in previous studies to hydrodynamic simulations initialized with a two-component Monte Carlo Glauber (MC-Glb.) model and initial conditions derived from Color Glass Condensate effective field theory using the Monte Carlo Kharzeev-Levin-Nardi (MC-KLN) model. Future studies might expand this coverage to more modern calculations of the QGP initial conditions in order to systematically constrain hydrodynamic transport coefficients and auxiliary parameters for each initialization model described in the literature. Once the models are appropriately optimized, the accuracy of the different theory calculations can be assessed using an appropriately chosen goodness of fit measure or, as typically used in Bayesian methodology, an integrated likelihood that a given model describes experiment. 

An alternative approach to this method of direct model validation is to parameterize the QGP initial conditions and apply Bayesian parameter estimation to determine systematic constraints on the initial energy (or entropy) deposited by competing models. The approach was first introduced in a comprehensive Bayesian analysis of heavy-ion collisions at RHIC and the LHC which constrained parameterized forms of the event-averaged initial conditions and temperature dependence of the QGP equation of state using viscous hydrodynamics coupled to a hadronic afterburner.  

In this work we extend the study of parametric initial conditions using a recently developed

build the previous effort to parameterize and constrain the QGP initial conditions and perform a Bayesian analysis of event-by-event viscous hydrodynamics with parametric initial condition


\section{Modeling the QGP evolution}

State-of-the-art heavy-ion collision models simulate QGP spacetime evolution in several stages \cite{Bass:2000ib,Teaney:2001av,Hirano:2005xf,Nonaka:2006yn,Petersen:2008dd,Song:2010mg,Schenke:2010rr,Shen:2014vra}:
\begin{enumerate}
  \item an initial condition model describes the initial state and non-equilibrium dynamics until QGP formation,
  \item viscous relativistic hydrodynamics calculates the dynamical expansion of the hot and dense QGP medium including the phase transition to a hadron gas,
  \item then a particlization model converts the system into a microscopic ensemble of hadrons,
  \item and finally a Boltzmann transport model calculates hadronic rescattering and decays.
\end{enumerate}
In this work, we opt for a mature, well-tested set of event-by-event models \cite{Shen:2014vra}  for the hydrodynamic evolution of the QGP and subsequent microscopic evolution of the hadronic phase. The initial condition will be provided by a novel parametric approach \cite{}.

\begin{figure*}
    \includegraphics{cgc_compare}
    \caption{Profiles of the initial thermal distribution predicted by the KLN (left), EKRT (middle) and wounded nucleon (right) models (dashed black lines) compared to a generalized mean with different values of the parameter $p$ (solid blue lines). Staggered lines show different cross sections of the initial entropy density $dS/(d^2r_\perp dy)$ as a function of the nucleon density $T_A$ for several values of $T_B = 1, 2, 3$ [fm$^{-2}$].} 
\end{figure*}

\subsection{Initial state models vs. parametric initial conditions}
\label{ic}

Ab-initio initial state models allow for the dynamical calculation of thermalization
and QGP formation and provide the initial conditions for the subsequent hydrodynamic 
evolution of the QGP \cite{}. A rigorous test of these models requires their integration
into a description for the full time-evolution of the heavy-ion collision that includes 
formation of the QGP, hydrodynamic evolution, hadronization and hadronic final state 
interactions. This can become computationally very challenging, given that the 
sizeable computational cost of calculating the early time off-equilibrium evolution adds 
onto the very significant computational effort required for the event-by-event evolution 
of the QGP and its decay products.

In this paper we will pursue an alternative method for determining the initial condition
of the hydrodynamic evolution, utilizing Bayesian statistics and a multi-parameter 
model to data comparison. With the help of a parametric initial condition model, Trento, we aim to
provide a likelihood distribution for the features of the initial condition that are 
compatible with the data taken at the LHC. The resulting high likelihood 
initial conditions can then be compared to the outcome of ab-initio initial state and 
early-time dynamical models at the time of QGP formation, thus providing valuable 
insight into their viability without the need for a full initial-to-final-state model 
calculation.


\begin{figure}
    \includegraphics{trento_events}
    \caption{Several \protect\trento\ Pb+Pb initial condition events for the transverse entropy density $dS/(d^2r_\perp dy)$ calculated using generalized mean parameter $p=0$, nucleon width $w=0.5$ fm and gamma fluctuation factor $k=1.4$.}
\end{figure}

\begin{figure}[b]
    \includegraphics{thickness}
    \caption{Cross section of the participant nucleon density in a mid-central Pb+Pb collision at $\sqrts=2.76$ TeV as a function of the transverse coordinate $x$ parallel to impact parameter $\vec{b}$. The gray band indicates the region bounded by the minimum and maximum values of the local participant thickness functions $T_A$ and $T_B$, while the blue band indicates the region spanned by the generalized mean of $T_A$ and $T_B$ with parameter $-1<p<1$. The solid blue line shows an example of a discrete mapping specified by a generalized mean with $p=0$.} 
\end{figure}

\subsection{Hydrodynamics and Boltzmann transport}


\section{Constraining the model}

\begin{figure*}
    \includegraphics{validation}
    \caption{Emulator validation for pion yield $dN/dy_{\pi^\pm}$ (left), average transverse momentum ${\langle p_T \rangle}_{\pi^\pm}$ (middle) and flow cumulant $v_2\{2\}$ (right) for centralities 0--5\% (blue) and 30--40\% (orange). The horizontal axis shows predictions by the emulator at untested regions of parameter space, and the vertical axis shows the same quantity after it has been calculated directly from the model. The gray line indicates perfect model and emulator agreement.} 
\end{figure*}


\begin{figure*}
    \includegraphics{posterior_identified}
    \caption{Diagonal and lower-diagonal: posterior marginal and joint distributions of the calibration parameters described in section \ref{?}. Diagonal entries show the posterior likelihood distribution of each parameter marginalized over remaining parameters, while lower-diagonal entries show the joint distribution of parameter pairs. Upper diagonal: the Pearson product-moment correlation coefficient $\rho_{X,Y}=\text{cov}(X,Y)/(\sigma_X \sigma_Y)$ for each pair of parameters $X$, $Y$. Red (blue) tiles indicate Pearson coefficients close to $1$ ($-1$) corresponding to strong linear correlation (anti-correlation). $^\dagger$The units for $\eta/s$ slope are [GeV$^{-1}$].}
    \label{fig:posterior_identified}
\end{figure*}

\begin{figure*}
    \includegraphics{posterior_compare}
    \caption{Comparison of the posterior distributions obtained when the model is calibrated to fit identified pion, kaon and proton yields $dN/dy$ (blue lines), and when the model is calibrated to fit integrated charged particles $d\nch/d\eta$ (orange lines). $^\dagger$The units for $\eta/s$ slope are [GeV$^{-1}$].}
\end{figure*}

\begin{figure*}
    \includegraphics{observables_plot}
    \caption{Identified yields (left column), mean $p_T$ (middle column) and flow cumulants $v_n\{2\}$ (right column). The top row shows results obtained from the training data used to condition the emulator. from 100 random samples drawn from the Bayesian posterior.}
\end{figure*}

\section{Results}

\begin{table}
    \caption{High likelihood parameters selected from the posterior distribution in Fig.~\ref{fig:posterior_identified} used to generate Fig.~\ref{fig:mode_observables}}
    \begin{ruledtabular}    
        \begin{tabular}{llll}
            \multicolumn{2}{c}{Initial condition} & \multicolumn{2}{c}{QGP medium} \\
            \noalign{\smallskip}\hline\noalign{\smallskip}
            norm & 120.          &  $\eta/s$ min   & 0.08       \\
            $p$  & 0.0           &  $\eta/s$ slope & 0.85 GeV$^{-1}$   \\
            $k$  & 1.5           &  $\zeta/s$ norm & 1.25       \\
            $w$  & 0.43 fm       &  $T_\text{sw}$  & 0.148 GeV  \\
        \end{tabular}
    \end{ruledtabular}
    \label{table:likely_param}
\end{table}

\begin{figure*}
    \includegraphics{mode_observables}
    \caption{Top row: model calculations of identified yields $dN/dy$, mean $p_T$ and flow cumulants $v_n\{2\}$ as a function of collision centrality using high-likelihood parameters (listed in table \ref{table:likely_param}) determined from the posterior in Fig.~\ref{fig:posterior_identified}. Symbols with error bars show data from ALICE and lines show results of the model. Bottom row: ratio of the model divided by experiment. Gray band indicates 10\% discrepancy between the model and experiment.}
    \label{fig:mode_observables}
\end{figure*}


\subsection{Constraining initial conditions}
\begin{figure}
    \includegraphics{nch_per_npart}
    \caption{Average charged particle density per participant pair $(d\nch/d\eta)/(\npart/2)$ as a function of participant number for Pb+Pb and p+Pb collisions at $\sqrts=5.02$ TeV.
    Symbols are data from ALICE and lines are model calculations from \protect\trento\ using parameters selected by the Bayesian analysis.}
\end{figure}

\begin{figure}
    \centering
    \includegraphics{posterior_p_arrows}
    \caption{Posterior on the generalized mean parameter $p$ which modulates the intensity of saturation effects in the initial conditions compared to the effective p-values needed to fit
    the KLN, EKRT and wounded nucleon (WN) models.}
    \label{posterior_p_arrows}
\end{figure}

\begin{figure}
    \centering
    \includegraphics{ipglasma}
    \caption{Comparison of trento parameteric initial conditions
    Charged particle multiplicity $d\nch/d\eta$ (top) and eccentricity harmonics $\varepsilon_n$ (bottom) for ${\sqrt{s_{NN}}=2.76}$ TeV Pb+Pb collisions as a function of impact parameter $b$. \protect\trento\ results using parameters drawn from the Bayesian posterior in Fig.~\ref{fig:posterior_identified} (solid lines) compared to results from the IP-Glasma model. Each \protect\trento\ initial condition event is freestreamed an additional 0.4 fm/c to match the pre-equilibrium evolution time of Classical Yang-Mills dynamics in the IP-Glasma model.}
\end{figure}

\subsection{Determining QGP medium properties}
\begin{figure}
    \includegraphics{viscosity_samples}
    \caption{Posterior constraints on the temperature dependent shear viscosity $(\eta/s)(T)$ (top panel) and temperature dependent bulk viscosity $(\zeta/s)(T)$ (bottom panel). The gray shaded regions mark the allowable values of $\eta/s$ and $\zeta/s$ used in the design while blue lines represent sample curves drawn from the posterior distributions of $\eta/s$ min, $\eta/s$ slope and $\zeta/s$ norm in Fig.~\ref{fig:posterior_identified}. unscaled bulk viscosity curve with unit norm (black line) used by the authors in \ref{?} is shown for reference.}
\end{figure}

\section{Conclusion}

\acknowledgements
The authors thank Ulrich Heinz, Scott Pratt and Harri Niemi for helpful discussions and clarifications in the production of the manuscript.
\appendix

\begin{figure*}
    \includegraphics{posterior_integrated}
    \caption{Presentation is identical to Fig.~\ref{fig:posterior_identified}, but with charged particle yields replacing identified pion, kaon and proton yields in the calibration process. The resulting posterior distributions are generally less constrained, and several marginal distributions along the diagonal are affected noticeably (see Fig.~\ref{fig:posterior_comparison} for a direct comparison). For example, the initial condition normalization increases significantly (top-left panel) and the hydro-to-urqmd switching temperature is completely washed out (bottom-right panel). $^\dagger$The units for $\eta/s$ slope are [GeV$^{-1}$]. }
\end{figure*}


\bibliography{trento2}


\end{document}
